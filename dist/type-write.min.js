!function(t,e){"use strict";function i(t,i){i=i||{};var n={};for(var s in t)n[s]=i[s]!==e?i[s]:t[s];return n}function n(e){var i;return i="string"==typeof e?t.document.querySelector(e):e}function s(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}var r={talkDelay:.04,duration:.5,commaWait:1,periodWait:2},a={START_TAG:"{",END_TAG:"}",BR:"|",START_WRAP:"<",END_WRAP:">"},o={textElm:"#text",prefix:["webkit","moz","o","ms"],typeWriteSetting:r,metaChara:a,onStart:null,onEnd:null},l=/[,\u3001\uFF64]/,_=/[\.\u3002\uFF61]/,h=function(t){return this.initialize(t),this};h.prototype={constructor:h,initialize:function(t){this._setting=i(o,t),this._typeWriteSetting=i(r,this._setting.typeWriteSetting),this._metaChar=i(a,this._setting.metaChara),this._textElm=n(this._setting.textElm),this._onStart=this._setting.onStart||null,this._onEnd=this._setting.onEnd||null,this._onEndTimer=null},start:function(t,e){e&&(this._typeWriteSetting=i(this._setting.typeWriteSetting,e)),this._textElm.innerHTML="",this._parseAndTypeWrite(t)},skip:function(){this._resetTransition()},_parseAndTypeWrite:function(t){for(var e,i=this._metaChar,n=this._typeWriteSetting,s=!1,r=!1,a=!1,o="",h=0,p=0,u=t.length,d=u-1;u>p;p++)if(e=t[p],0===p&&this._onStart&&this._onStart(),e===i.START_TAG&&(s=!0),s){switch(e){case i.END_TAG:s=!1;break;case i.BR:this._addBr();break;case i.START_WRAP:r=!0;break;case i.END_WRAP:r=!1,o=""}if(r&&s)switch(e){case i.START_WRAP:break;default:o+=e}}else a=p===d,r?this._addTransitionSpan(e,p,h,o,a):this._addTransitionSpan(e,p,h,null,a),l.test(e)?h+=n.commaWait:_.test(e)&&(h+=n.periodWait)},_addBr:function(){var t=document.createElement("br");this._textElm.appendChild(t)},_addTransitionSpan:function(t,e,i,n,s){var r=this._typeWriteSetting,a=r.talkDelay*(e+1)+i,o=["opacity",r.duration+"s","linear",a+"s"].join(" "),l=document.createElement("span");if(l.textContent=t,l.style.opacity=0,this._applyPrefixStyle(l,"transition",o),n&&(l.className=n),this._textElm.appendChild(l),setTimeout(function(){l.style.opacity=1}),s){var _=1e3*(r.duration+a),h=this;h._onEndTimer=setTimeout(function(){h._onEnd&&h._onEnd(),h._dispose()},_)}},_resetTransition:function(){var t=this._textElm.childNodes;for(var e in t)1===t[e].nodeType&&this._applyPrefixStyle(t[e],"transition","");this._onEnd&&this._onEnd(),this._dispose()},_applyPrefixStyle:function(t,e,i){t.style[e]=i;var n=this._setting.prefix;e=s(e);for(var r=0,a=n.length;a>r;r++)t.style[n[r]+e]=i},_dispose:function(){clearTimeout(this._onEndTimer),this._onEndTimer=null}};var p="function"==typeof t.define&&t.define.amd,u="object"==typeof t.exports&&t.exports;p?define([],function(){return h}):u?module.exports=h:t.TypeWrite=h}(this.self||global);