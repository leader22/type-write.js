!function(t,i){"use strict";function e(t,e){e=e||{};var n,s={};for(n in t)s[n]=t[n];for(n in e)e[n]!==i&&(s[n]=e[n]);return s}function n(i){var e;return e="string"==typeof i?t.document.querySelector(i):i}function s(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}var r={talkDelay:.04,duration:.5,commaWait:1,periodWait:2},a={START_TAG:"{",END_TAG:"}",BR:"|",START_WRAP:"<",END_WRAP:">"},o={textElm:"#text",prefix:["webkit","moz","o","ms"],typeWriteSetting:r,metaChara:a,onStart:null,onEnd:null},l=/[,\u3001\uFF64]/,_=/[\.\u3002\uFF61]/,h=function(t){return this.initialize(t),this};h.prototype={constructor:h,initialize:function(t){this._setting=e(o,t),this._typeWriteSetting=e(r,this._setting.typeWriteSetting),this._metaChar=e(a,this._setting.metaChara),this._textElm=n(this._setting.textElm),this._onStart=this._setting.onStart||null,this._onEnd=this._setting.onEnd||null,this._onEndTimer=null},start:function(t,i){i&&(this._typeWriteSetting=e(this._setting.typeWriteSetting,i)),this._textElm.innerHTML="",this._parseAndTypeWrite(t)},skip:function(){this._resetTransition()},_parseAndTypeWrite:function(t){for(var i,e=this._metaChar,n=this._typeWriteSetting,s=!1,r=!1,a=!1,o="",h=0,p=0,u=t.length,d=u-1;u>p;p++)if(i=t[p],0===p&&this._onStart&&this._onStart(),i===e.START_TAG&&(s=!0),s){switch(i){case e.END_TAG:s=!1;break;case e.BR:this._addBr();break;case e.START_WRAP:r=!0;break;case e.END_WRAP:r=!1,o=""}if(r&&s)switch(i){case e.START_WRAP:break;default:o+=i}}else a=p===d,r?this._addTransitionSpan(i,p,h,o,a):this._addTransitionSpan(i,p,h,null,a),l.test(i)?h+=n.commaWait:_.test(i)&&(h+=n.periodWait)},_addBr:function(){var t=document.createElement("br");this._textElm.appendChild(t)},_addTransitionSpan:function(t,i,e,n,s){var r=this._typeWriteSetting,a=r.talkDelay*(i+1)+e,o=["opacity",r.duration+"s","linear",a+"s"].join(" "),l=document.createElement("span");if(l.textContent=t,l.style.opacity=0,this._applyPrefixStyle(l,"transition",o),n&&(l.className=n),this._textElm.appendChild(l),setTimeout(function(){l.style.opacity=1}),s){var _=1e3*(r.duration+a),h=this;h._onEndTimer=setTimeout(function(){h._onEnd&&h._onEnd(),h._dispose()},_)}},_resetTransition:function(){var t=this._textElm.childNodes;for(var i in t)1===t[i].nodeType&&this._applyPrefixStyle(t[i],"transition","");this._onEnd&&this._onEnd(),this._dispose()},_applyPrefixStyle:function(t,i,e){t.style[i]=e;var n=this._setting.prefix;i=s(i);for(var r=0,a=n.length;a>r;r++)t.style[n[r]+i]=e},_dispose:function(){clearTimeout(this._onEndTimer),this._onEndTimer=null}};var p="function"==typeof t.define&&t.define.amd,u="object"==typeof t.exports&&t.exports;p?define([],function(){return h}):u?module.exports=h:t.TypeWrite=h}(this.self||global);